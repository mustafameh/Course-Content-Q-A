<!DOCTYPE html>
<html>
<head>
    <title>Authentication Test</title>
    <style>
        .container {
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .response {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Register User</h2>
        <div class="form-group">
            <input type="email" id="reg-username" placeholder="Email">
            <input type="password" id="reg-password" placeholder="Password">
            <select id="reg-role">
                <option value="student">Student</option>
                <option value="professor">Professor</option>
            </select>
            <button onclick="register()">Register</button>
        </div>

        <h2>Login</h2>
        <div class="form-group">
            <input type="email" id="login-username" placeholder="Email">
            <input type="password" id="login-password" placeholder="Password">
            <button onclick="login()">Login</button>
        </div>

        <button onclick="logout()">Logout</button>

        <div id="response" class="response"></div>
    </div>

    <script>
        function showResponse(data) {
            document.getElementById('response').innerHTML = JSON.stringify(data, null, 2);
        }

        async function register() {
            const username = document.getElementById('reg-username').value;
            const password = document.getElementById('reg-password').value;
            const role = document.getElementById('reg-role').value;

            try {
                const response = await fetch('/auth/users', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password, role }),
                });
                const data = await response.json();
                showResponse(data);
            } catch (error) {
                showResponse({ error: error.message });
            }
        }

        async function login() {
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;

            try {
                const response = await fetch('/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password }),
                });
                const data = await response.json();
                showResponse(data);
            } catch (error) {
                showResponse({ error: error.message });
            }
        }

        async function logout() {
            try {
                const response = await fetch('/auth/logout', {
                    method: 'POST',
                });
                const data = await response.json();
                showResponse(data);
            } catch (error) {
                showResponse({ error: error.message });
            }
        }
    </script>
    
</body>
</html>